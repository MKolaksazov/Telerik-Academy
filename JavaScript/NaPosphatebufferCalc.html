<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="UTF-8">
      <title>Sodium Phosphate Buffer Calculator</title>
      <style>
         form {
         display: flex;
         flex-direction: column;
         margin-bottom: 20px;
         }
         label {
         display: block;
         margin-bottom: 10px;
         }
         input {
         width: 98%;
         padding: 5px;
         border: 1px solid #ccc;
         }
         button {
         padding: 10px 20px;
         background-color: #007bff;
         color: white;
         border: none;
         cursor: pointer;
         }
      </style>
   </head>
   <body>
      <h1>Sodium Phosphate Buffer Calculator</h1>
      <form id="bufferForm">
         <label for="pH">Desired pH:</label>
         <input type="number" id="pH" name="pH" min="1" max="14" step="0.1" required>
         <label for="molarity">Desired Molarity [mM]:</label>
         <input type="number" id="molarity" name="molarity" min="0" step="0.001" required>
         <label for="finalVolume">Final Volume [mL]:</label>
         <input type="number" id="finalVolume" name="finalVolume" min="0" required>
         <label for="temperature">Preparation Temperature [o C]:</label>
         <input type="number" id="temperature" name="temperature" min="0" step="1" required>
         <button type="button" onclick="calculateBuffer();">Calculate Buffer Composition</button>
      </form>
      <div id="bufferResult"></div>
      <script>
         function calculateBuffer() {
         
const pH = parseFloat(document.getElementById('pH').value);
const molarity = parseFloat(document.getElementById('molarity').value);
const volume = parseFloat(document.getElementById('finalVolume').value);
const temperature = parseFloat(document.getElementById('temperature').value);
         
// Calculate the concentrations of sodium phosphate and disodium phosphate
const MW_NaH2PO4_7H2O = 268.074; // Molecular weight of sodium phosphate dibasic heptahydrate
const MW_Na2HPO4_H2O = 137.99; // Molecular weight of sodium phosphate monobasic monohydrate


	var hyd = Math.exp(-pH*Math.LN10)

	var K1 = Math.exp(-2.148*Math.LN10)
	var K2 = Math.exp(-6.795*Math.LN10)
	var K3 = Math.exp(-12.319*Math.LN10)

	var ratio1 = hyd/K1
	var ratio2 = hyd/K2
	var ratio3 = hyd/K3

	var ratio0 = 1.0
	ratio1 = ratio0/ratio1
	ratio2 = ratio1/ratio2
	ratio3 = ratio2/ratio3

	var sum=ratio0 + ratio1 + ratio2 + ratio3

	ratio0 = ratio0/sum*molarity/1000
	ratio1 = ratio1/sum*molarity/1000
	ratio2 = ratio2/sum*molarity/1000
	ratio3 = ratio3/sum*molarity/1000

	var msp = (ratio0 + ratio1)*MW_Na2HPO4_H2O/10
	var dsp = (ratio2 + ratio3)*MW_NaH2PO4_7H2O/10

	msp = Math.round(msp*10000)/10000
	dsp = Math.round(dsp*10000)/10000

    var vmsp = msp * molarity * 2 * volume / 10000
    var vdsp = dsp * molarity * 2 * volume / 10000

           // Display the buffer composition in the result div
const resultDiv = document.getElementById('bufferResult');
resultDiv.innerHTML = `<h2>Buffer Composition</h2>`;
resultDiv.innerHTML += `<p>pH: ${pH}</p>`;
resultDiv.innerHTML += `<p>Molarity: ${molarity} mM</p>`;
resultDiv.innerHTML += `<p>Final Volume: ${volume} mL</p>`;
resultDiv.innerHTML += `<p>Temperature: ${temperature} o C</p>`;
resultDiv.innerHTML += `<p>Adjusted amount of NaH2PO4_7H2O: ${dsp.toFixed(2)} % ${vdsp.toFixed(2)} g</p>`;
resultDiv.innerHTML += `<p>Adjusted amount of Na2HPO4_H2O: ${msp.toFixed(2)} % ${vmsp.toFixed(2)} g</p>`;

         }
      </script>
   </body>
</html>
